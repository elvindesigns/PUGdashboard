<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PUG Dashboard</title>
    <link rel="stylesheet" href="./css/bootstrap-grid.css">
    <link rel="stylesheet" href="./css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- <script src="https://maps.google.com/maps/api/js?sensor=false"></script> -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyChJ4jMRyDhNHmnB8RhigdGcSe8eEiPLsk&callback=initMap"></script>
</head>
<body>
    <div class="mainBg ">
        <div class="menuBar">
            <div class="menuHolder container">
                <div>
                    <h3>PUG DISCO Dashboard</h3>
                    <p>Payafrik Universal Gateway</p>
                </div>
                <div class="iconHolder">
                    <div>
                        <a class="iconButton iconButtonActive" href="#">
                            <img src="./images/pie.png" alt="">
                        </a>
                        
                    </div>
                    <div>
                        <a class="iconButton" href="#">
                            <img src="./images/map.png" alt="">
                        </a>
                        
                    </div>
                    <div>
                        <a class="iconButton" href="#">
                            <img src="./images/chat.png" alt="">
                        </a>
                        
                    </div>
                </div>
                <div class="menuLogoHolder">
                    <img class="menuLogo" src="./images/logo.png" alt="">
                </div>
            </div>
        </div>
        <div class="featureBody container">  
            <div class="usersHolder">
                <div class="title"><p>Users</p></div>
                <div class="countHolder row">
                    <div class="col ">
                        <p class="count">006</p>
                        <p class="desc">Active Users</p>
                        <div class="bar activeBGColor"></div>
                    </div>
                    <div class="col">
                        <p class="count">001</p>
                        <p class="desc">InActive Users</p>
                        <div class="bar inactiveBGColor"></div>
                    </div>
                    <div class="col">
                        <p class="count">002</p>
                        <p class="desc">InActive Users</p>
                        <div class="bar cutoffBGColor"></div>
                    </div>
                </div>
                <div class="usersChartHolder">
                    <canvas id="usersChart" width="200" height="200"></canvas>
                    <div class="totalHolder">
                        <p class="totalCount">009</p>
                        <p class="totalDesc">total number</p>
                        <p class="totalDesc">of users</p>
                    </div>
                </div>
                <div>
                    <div class="legendSingle" onclick="newLocation(9.116693713152465, 7.3843472685799005)">
                        <div class="colorBlock1"></div>
                        <p>Active Users</p>
                    </div>
                    <div class="legendSingle">
                        <div class="colorBlock2"></div>
                        <p>InActive Users</p>
                    </div>
                    <div class="legendSingle">
                        <div class="colorBlock3"></div>
                        <p>Cut Off Users</p>
                    </div>
                </div>
                
            </div>
            <div class="usersHolder2">
                <div>
                    <input id="searchBar" placeholder="Search Here" type="text">
                </div>
                <p>search by name</p>
                <table class="customTable">
                    <thead>
                      <tr>
                        <th>Name</th>
                        <th>Status</th>
                        <th></th>
           
                      </tr>
                    </thead>
                    <tbody>
                      <tr >
                        <td onclick="newLocation(0)" class="tname">Mr. Ndagijimana John</td>
                        <td class="active">Active</td>
                        <td onclick="displayModal(0)" class="action">:</td>
                        
                      </tr>
                      <tr  >
                        <td onclick="newLocation(1)" class="tname">Eng. Ntakirutimana Caleb</td>
                        <td class="active">Active</td>
                        <td onclick="displayModal(1)" class="action">:</td>
                       
                      </tr>
                      <tr  >
                        <td onclick="newLocation(2)" class="tname">Mrs. Kayitesi Gabriel</td>
                        <td class="active">Active</td>
                        <td onclick="displayModal(2)" class="action">:</td>
      
                      </tr>
                      <tr  >
                        <td onclick="newLocation(3)" class="tname">Mr  Iyakaremye Micheal</td>
                        <td class="inactive">Inactive</td>
                        <td onclick="displayModal(3)" class="action">:</td>
               
                      </tr>
                      <tr  >
                        <td onclick="newLocation(4)" class="tname">Mrs Nana  Patrick</td>
                        <td class="active">Active</td>
                        <td onclick="displayModal(4)" class="action">:</td>
               
                      </tr>
                      <tr  >
                        <td onclick="newLocation(5)" class="tname">Mrs Anastase  John</td>
                        <td class="cutoff">Cut-Off</td>
                        <td onclick="displayModal(5)" class="action">:</td>
               
                      </tr>
                      <tr  >
                        <td onclick="newLocation(6)" class="tname">Barr.  Aurore  Bogarde</td>
                        <td class="active">Active</td>
                        <td onclick="displayModal(6)" class="action">:</td>
               
                      </tr>
                      <tr  >
                        <td onclick="newLocation(7)" class="tname">Mrs Nkurunziza bwami</td>
                        <td class="active">Active</td>
                        <td onclick="displayModal(7)" class="action">:</td>
               
                      </tr>
                      <tr  >
                        <td onclick="newLocation(8)" class="tname">Mungwasingizwe  Ndagijimana</td>
                        <td class="cutoff">Cut-Off</td>
                        <td onclick="displayModal(8)" class="action">:</td>
               
                      </tr>
                    </tbody>
                  </table>
                  <p id="showing">showing 9 of 9 users</p>
            </div>
            <div class="mapHolder" id="map">

            </div>
        </div>
        <!-- The Modal -->
        <div id="myModal" class="modal">

            <!-- Modal content -->
            <div class="modal-content">
            <span onclick="closeModal()" class="close">&times;</span>
            <p class="modalTitle">USER DETAILS</p>
            <p class="modalDesc">METER NO.</p>
            <p id="meterNo"></p>
            <p class="modalDesc">CUSTOMER NAME</p>
            <p id="customerName" class="otherDetails"></p>
            <p class="modalDesc">CUSTOMER ADDRESS</p>
            <p id="customerAddress" class="otherDetails"></p>
            <p class="modalDesc">METER TYPE</p>
            <p  class="otherDetails">3 Phase</p>
            </div>
        
        </div>

    </div> 


    <script>
        var ctx = document.getElementById('usersChart').getContext('2d');
        var myChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                // labels: ['Active Users', 'InActive Users', 'Cut Off Users'],
                datasets: [{
                    cutout:'70%',
                    label: '# of Votes',
                    data: [6, 1, 2],
                    backgroundColor: [
                        'rgba(253, 62, 113, 1)',
                        'rgba(255, 186, 0, 1)',
                        'rgba(255, 0, 255, 1)',
                    ],
                    // hoverOffset: 4,
                    borderWidth: 0,
                    
                }]
            },
        });
       

        var LocationsForMap = [
        ['Mr. Ndagijimana John',-1.889734, 30.112747,45669656465,'Gasabo Main',127.3,'Trinity Apartments caleb Road  Gasabo','FDR 1','Mont_Gb_Kg_001','01'],
        ['Eng. Ntakirutimana Caleb', -2.006294, 30.136184,45669656466,'Kicukiro_1A', 54.2,'A Class Blocks by studio Road Kicukiro','FDR 1','Gikondo_Ki_Kg_001','02'],
        ['Mrs. Kayitesi Gabriel', -1.886030, 30.107348,45669656467,'Gasabo Main',28.1,'Eve Esatate Gasabo','FDR 2','Nzove_Gb_Kg_001','01'],
        ['Mr Iyakaremye Micheal',  -1.885969, 30.106763,45669656468,'Gasabo Main',0.0,'Rwandan franc Apartments Gasabo','FDR 2','Nzove_Gb_Kg_002','01'],
        ['Mrs Nana  Patrick',   -1.957510, 30.083927,45669656469,'Kimihurura',221.4,'Kimihurura public garden block','FDR 2','Gasogi_Kh_Kg_001','05'],
        ['Mrs Anastase  John',  -1.866793,	29.980251,45669656470,'Kacyiru', 45.7,'Isheja Apartment Kacyiru','FDR 2','Nyakabingo_Kh_Kg_001','01'],
        ['Barr. Aurore  Bogarde',  -1.883060, 30.111144,45669656471,'Gasabo Main',349.2,'Bombay Studios Gasabo','FDR 2','Gasabo East_Gb_Kg_001','02'],
        ['Mrs Nkurunziza bwami',   -1.884493, 30.111174,45669656472,'Gasabo Main',32.8,'Classy J Resturants  Gasabo','FDR 2','Gasabo_Gb_Kg_002','01'],
        ['Mungwasingizwe  Ndagijimana',   -1.884039,30.108918,45669656473,'Gasabo Main',67.9,'Disney land Schools Gasabo','FDR 2','Gasabo_Gb_Kg_003','01'],
        // ['Washington', 47.751076,-120.740135]
        ];

        var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 11,
        center: new google.maps.LatLng(-1.889734, 30.112747),
        mapTypeId: google.maps.MapTypeId.ROADMAP
        });

        var infowindow = new google.maps.InfoWindow();

        var marker, i;

        for (i = 0; i < LocationsForMap.length; i++) {  
        marker = new google.maps.Marker({
            position: new google.maps.LatLng(LocationsForMap[i][1], LocationsForMap[i][2]),
            map: map,
            icon: "https://raw.githubusercontent.com/elvindesigns/PUGdashboard/master/images/marker2.png"
        });

        google.maps.event.addListener(marker, 'click', (function(marker, i) {
            return function() {
            infowindow.setContent("<p class='titleBold'>"+LocationsForMap[i][0]+"</p>"+
                                  "<p class='meterno'>Meter No.: "+LocationsForMap[i][3] +" </p>"+
                                  "<p class='substation'>Substation: "+LocationsForMap[i][4] +" </p>"+
                                  "<p class='substation'>Feeder: "+LocationsForMap[i][7] +" </p>"+
                                  "<p class='substation'>DT Name: "+LocationsForMap[i][8] +" </p>"+
                                  "<p class='poleno'>Pole No.: "+LocationsForMap[i][9] +" </p>"+
                                  "<p class='unitsTitle'>Available units</p>"+
                                  "<p class='units'> "+LocationsForMap[i][5] +"kWH </p>");
            infowindow.open(map, marker);
            }
        })(marker, i));
        }
        // var bounds = new google.maps.LatLngBounds();
        // map.fitBounds(bounds);

        function newLocation(index)
        {
            
            map.setCenter({
                lat : LocationsForMap[index][1],
                lng : LocationsForMap[index][2]
            });
            map.setZoom(17)
            marker = new google.maps.Marker({
                position: new google.maps.LatLng(LocationsForMap[index][1], LocationsForMap[index][2]),
                map: map,
                icon: "https://raw.githubusercontent.com/elvindesigns/PUGdashboard/master/images/marker2.png"
            });
            infowindow.setContent("<p class='titleBold'>"+LocationsForMap[index][0]+"</p>"+
                                  "<p class='meterno'>Meter No.: "+LocationsForMap[index][3] +" </p>"+
                                  "<p class='substation'>Substation: "+LocationsForMap[index][4] +" </p>"+
                                  "<p class='substation'>Feeder: "+LocationsForMap[index][7] +" </p>"+
                                  "<p class='substation'>DT Name: "+LocationsForMap[index][8] +" </p>"+
                                  "<p class='poleno'>Pole No.: "+LocationsForMap[index][9] +" </p>"+
                                  "<p class='unitsTitle'>Available units</p>"+
                                  "<p class='units'> "+LocationsForMap[index][5] +"kWH </p>");
            infowindow.open(map, marker);
        }

        function displayModal(index){
            // Get the modal
            var modal = document.getElementById("myModal");
            var meterNo = document.getElementById("meterNo");
            var customerName = document.getElementById("customerName");
            var customerAddress = document.getElementById("customerAddress");
            modal.style.display = "block";
            // // When the user clicks anywhere outside of the modal, close it
            // window.onclick = function(event) {
            //     if (event.target == modal) {
            //         modal.style.display = "none";
            //     }
            // }
            meterNo.innerText = LocationsForMap[index][3];
            customerName.innerText = LocationsForMap[index][0];
            customerAddress.innerText = LocationsForMap[index][6];

        }
        function closeModal(){
            var modal = document.getElementById("myModal");
            modal.style.display = "none";
        }

        
    </script>
</body>
</html>